<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Starfleet Academy</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --gold: #ffcc66;
      --blue: #0077cc;
      --green: #00cc66;
      --red: #cc0033;
      --dark-blue: #001933;
      --black: #000;
      --text: #e6e6e6;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: var(--black);
      font-family: 'Roboto', sans-serif;
      color: var(--text);
      overflow-x: hidden;
      transition: opacity 1s ease;
    }

    .page-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 36pt;
      color: var(--gold);
      text-align: center;
      margin: 20px 0 10px;
    }

    #loginScreen {
      position: relative;
      height: 100vh;
      width: 100%;
      background: url("Starfleet Academy - San Francisco.gif") no-repeat center center fixed;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 1;
      transition: opacity 1.5s ease;
    }

    #loginScreen.fade-out { opacity: 0; }

    #mainScreen {
      display: none;
      opacity: 0;
      transition: opacity 1.5s ease;
    }

    #mainScreen.fade-in {
      display: flex;
      opacity: 1;
    }

    .lcars-left,
    .lcars-top,
    .lcars-bottom {
      position: absolute;
      background: var(--dark-blue);
    }

    .lcars-left {
      top: 0;
      left: 0;
      width: 240px;
      height: 100%;
      border-right: 6px solid var(--gold);
    }

    .lcars-top {
      top: 0;
      left: 0;
      width: 100%;
      height: 50px;
      background: var(--gold);
      border-bottom-left-radius: 50px;
    }

    .lcars-bottom {
      bottom: 0;
      left: 0;
      width: 100%;
      height: 40px;
      background: var(--gold);
      border-top-left-radius: 50px;
    }

    .container {
      background: rgba(0, 0, 0, 0.8);
      border: 2px solid var(--gold);
      border-radius: 12px;
      box-shadow: 0 0 20px var(--blue);
      padding: 30px 40px;
      width: 420px;
      z-index: 2;
    }

    label {
      display: block;
      color: var(--gold);
      font-size: 14pt;
      margin-bottom: 6px;
    }

    input, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 18px;
      background: #000;
      border: 1px solid var(--blue);
      color: var(--text);
      font-size: 14pt;
      border-radius: 6px;
    }

    button {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(to bottom, #003366, #001933);
      border: 2px solid var(--gold);
      color: var(--gold);
      font-size: 15pt;
      border-radius: 10px;
      padding: 12px 25px;
      margin: 10px;
      cursor: pointer;
      box-shadow:
        inset 0 6px 8px rgba(255, 255, 255, 0.06),
        inset 0 -6px 10px rgba(0, 0, 0, 0.6),
        0 6px 12px rgba(0, 0, 0, 0.9);
      transition: transform 0.2s, box-shadow 0.2s;
      white-space: normal;
      line-height: 1.4;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow:
        inset 0 6px 10px rgba(255, 255, 255, 0.08),
        inset 0 -6px 12px rgba(0, 0, 0, 0.7),
        0 14px 28px rgba(0, 0, 0, 1);
    }

    .department-select-box {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      justify-items: center;
      align-items: center;
      max-width: 700px;
      margin: 0 auto;
      background: rgba(0, 0, 0, 0.8);
      border: 2px solid var(--gold);
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 0 15px var(--blue);
    }

    .department-buttons-box {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
    }

    .corner-image {
      position: fixed;
      width: 2.5in;
      height: 2.5in;
      object-fit: contain;
      pointer-events: none;
    }

    .corner-left { top: 10px; left: 10px; }
    .corner-right { top: 10px; right: 10px; }

    #accessMessage {
      text-align: center;
      color: var(--gold);
      font-family: 'Orbitron', sans-serif;
      font-size: 16pt;
      margin-top: 12px;
      opacity: 0;
      transition: opacity 0.4s ease-in;
    }

    .lab-answers {
      display: flex;
      flex-direction: column;
      gap: 15px;
      align-items: stretch;
    }

    .lab-answers button {
      width: 100%;
      max-width: 100%;
      flex: 0 0 auto;
      white-space: normal;
      line-height: 1.4;
      box-sizing: border-box;
      margin: 5px 0;
    }

    .best-answer { color: var(--green); }
    .alternate-answer { color: var(--blue); }
    .incorrect-answer { color: var(--red); }

    .feedback {
      text-align: center;
      font-size: 16pt;
      margin-top: 15px;
    }

    #mainScreen {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      height: 100vh;
      width: 100%;
      text-align: center;
    }

    #mainScreen .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: calc(min(calc(100% - 6in), 1400px) - 100px);
      margin: 100px auto 0 auto;
    }

    #trainingPage .fixed-return {
      position: fixed;
      top: calc(50% + 250px);
      left: 5px;
      transform: translateY(-50%);
      z-index: 1000;
      bottom: auto;
    }

    @media (max-width: 900px) {
      #trainingPage .fixed-return {
        top: auto;
        bottom: 20px;
        transform: none;
      }
    }

    .training-section h3,
    .training-section > p {
      color: var(--gold);
    }

    .training-section:first-of-type p {
      color: var(--text);
    }

    #trainingContent .answers.department-buttons-box {
      align-items: flex-start !important;
    }

    #trainingContent .answers p,
    #trainingContent .answers div {
      text-align: left !important;
    }

    #trainingContent .answers p strong {
      color: var(--blue);
    }
  </style>
</head>

<body>
  <div id="loginScreen">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">
    <div class="lcars-left"></div>
    <div class="lcars-top"></div>
    <div class="lcars-bottom"></div>
    <div class="container">
      <div class="page-title">STARFLEET ACADEMY</div>
      <label for="cadetName">Cadet Name</label>
      <input type="text" id="cadetName" required>
      <label for="species">Species</label>
      <select id="species" required>
        <option value="">-- Select Species --</option>
        <option>Human</option>
        <option>Vulcan</option>
        <option>Andorian</option>
        <option>Aenar</option>
        <option>Tellarite</option>
        <option>Bajoran</option>
        <option>Betazoid</option>
        <option>Bolian</option>
        <option>Trill</option>
        <option>Klingon</option>
        <option>Ferengi</option>
        <option>Denobulan</option>
        <option>Orion</option>
        <option>Caitian</option>
        <option>Benzite</option>
      </select>
      <button id="loginBtn">Login</button>
      <p id="accessMessage">Access Granted</p>
    </div>
  </div>
  <div id="mainScreen">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">

    <div class="container">
      <div class="page-title">Welcome to Starfleet Academy</div>
      <div id="mainWelcome" style="font-size:18pt;margin-bottom:20px;"></div>

      <p style="font-size:14pt;color:#fff;margin-bottom:20px;text-align:center;max-width:900px;">
        Congratulations, Cadet. You have been accepted into Starfleet Academy,
        where the finest minds of the Federation prepare to serve in the vast
        frontier of space. Here, you will learn the disciplines of command,
        diplomacy, science, engineering, medicine, and security — each a vital
        pillar in the exploration and defense of the Federation.
      </p>

      <p style="font-size:14pt;color:#fff;margin-bottom:48px;text-align:center;max-width:900px;">
        Choose your path and begin studying by selecting the "Study" button below.
        When you're ready, return to this page and choose the "Labs" to test what you've learned.
        Once all labs are complete, you will take a final exam by choosing the "Exams" button.
        Good luck, Cadet!
      </p>

      <div class="department-select-box" style="grid-template-columns: repeat(3, 1fr); width:auto; background:rgba(0,0,0,0.8);">
        <button id="trainingBtn" style="width:200px;">Study</button>
        <button id="labBtn" style="width:200px;">Labs</button>
        <button id="examBtn" style="width:200px;">Exams</button>
      </div>
    </div>
  </div>

  <div id="orientationPage" style="display:none;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">

    <div class="orientation-root" style="text-align:center;margin-top:100px;">
      <div class="page-title" id="orientationTitle"></div>
      <div style="font-size:16pt;margin-bottom:30px;">Select a department to begin.</div>
      <div id="moduleButtons" class="department-select-box"></div>
      <button class="fixed-return" id="returnMain">Return to Main</button>
    </div>
  </div>

  <div id="trainingPage" style="display:none;text-align:center;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">

    <div class="page-title" id="trainingDeptTitle"></div>
    <div id="trainingCadetInfo" style="font-size:16pt;color:var(--gold);margin-bottom:20px;"></div>
    <div id="trainingContent" style="max-width:1000px;margin:0 auto;text-align:left;padding:20px;background:rgba(0,0,0,0.8);border:2px solid var(--gold);border-radius:12px;box-shadow:0 0 15px var(--blue);"></div>
    <button class="fixed-return" id="returnOrientationTrain">Back to Departments</button>
  </div>

  <div id="labPage" style="display:none;text-align:center;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">

    <div class="page-title" id="labDeptTitle"></div>
    <div id="labCadetInfo" style="font-size:16pt;color:var(--gold);margin-bottom:20px;"></div>
    <div id="labContent" style="max-width:1000px;margin:0 auto;text-align:left;padding:20px;background:rgba(0,0,0,0.8);border:2px solid var(--gold);border-radius:12px;box-shadow:0 0 15px var(--blue);"></div>
    <button class="fixed-return" id="returnOrientationLab">Back to Departments</button>
  </div>

  <div id="examPage" style="display:none;text-align:center;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">

    <div class="page-title" id="examDeptTitle"></div>
    <div id="examCadetInfo" style="font-size:16pt;color:var(--gold);margin-bottom:20px;"></div>
    <div id="examContent" style="max-width:1000px;margin:0 auto;text-align:left;padding:20px;background:rgba(0,0,0,0.8);border:2px solid var(--gold);border-radius:12px;box-shadow:0 0 15px var(--blue);"></div>
    <button class="fixed-return" id="returnOrientationExam">Back to Departments</button>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {

    const trainingFiles = {
      "Command": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Command%20Training.json",
      "Diplomacy": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Diplomacy%20Training.json",
      "Engineering": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Engineering%20Training.json",
      "Security": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Security%20Training.json",
      "Science": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Science%20Training.json",
      "Medical": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Medical%20Training.json"
    };

    const labFiles = {
      "Command": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Command%20Lab.json",
      "Diplomacy": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Diplomacy%20Lab.json",
      "Engineering": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Engineering%20Lab.json",
      "Security": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Security%20Lab.json",
      "Science": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Science%20Lab.json",
      "Medical": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Medical%20Lab.json"
    };

    const examFiles = {
      "Command": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Command%20Exam.json",
      "Diplomacy": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Diplomacy%20Exam.json",
      "Engineering": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Engineering%20Exam.json",
      "Security": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Security%20Exam.json",
      "Science": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Science%20Exam.json",
      "Medical": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Medical%20Exam.json"
    };

    const homeworlds = {
      "Human": "Earth", "Vulcan": "Vulcan", "Andorian": "Andoria", "Aenar": "Andoria",
      "Tellarite": "Tellar Prime", "Bajoran": "Bajor", "Betazoid": "Betazed", "Bolian": "Bolarus IX",
      "Trill": "Trill", "Klingon": "Qo'noS", "Ferengi": "Ferenginar", "Denobulan": "Denobula",
      "Orion": "Orion", "Caitian": "Cait", "Benzite": "Benzar"
    };
    const prefaces = {
      "Command": "For this training, you wear the captain’s uniform. The chair is yours, and every order you give carries the weight of command...",
      "Diplomacy": "In this training, you speak for the Federation itself...",
      "Engineering": "The heart of a starship beats in your hands...",
      "Science": "Curiosity is your compass, and knowledge your constant companion...",
      "Medical": "Every life aboard your ship depends on your steadiness and compassion...",
      "Security": "As Chief of Security, you stand between your crew and chaos..."
    };

    let cadetName = "", species = "";

    document.getElementById("loginBtn").addEventListener("click", () => {
      cadetName = document.getElementById("cadetName").value.trim();
      species = document.getElementById("species").value;
      if (!cadetName || !species) return alert("Enter name and species first.");
      const msg = document.getElementById("accessMessage");
      msg.textContent = `Access Granted — Welcome, Cadet ${cadetName} of ${homeworlds[species]}.`;
      msg.style.opacity = 1;
      setTimeout(() => {
        const login = document.getElementById("loginScreen");
        const main = document.getElementById("mainScreen");
        login.classList.add("fade-out");
        setTimeout(() => {
          login.style.display = "none";
          main.style.display = "flex";
          setTimeout(() => main.classList.add("fade-in"), 200);
          document.getElementById("mainWelcome").textContent = `Welcome, Cadet ${cadetName} of ${homeworlds[species]}.`;
        }, 1500);
      }, 5000);
    });

    document.getElementById("trainingBtn").onclick = () => openOrientation("training");
    document.getElementById("labBtn").onclick = () => openOrientation("lab");
    document.getElementById("examBtn").onclick = () => openOrientation("exam");

    function openOrientation(mode) {
      document.getElementById("mainScreen").style.display = "none";
      const title = document.getElementById("orientationTitle");
      title.textContent = mode === "lab" ? "Select Lab Department" :
                          mode === "exam" ? "Select Exam Department" : "Select Study Department";
      const box = document.getElementById("moduleButtons");
      box.innerHTML = "";
      Object.keys(trainingFiles).forEach(d => {
        const b = document.createElement("button");
        b.textContent = d;
        b.onclick = () => {
          if (mode === "training") loadTraining(d);
          else if (mode === "lab") loadLab(d);
          else loadExam(d);
        };
        box.appendChild(b);
      });
      document.getElementById("orientationPage").style.display = "block";
    }

    document.getElementById("returnMain").onclick = () => {
      document.getElementById("orientationPage").style.display = "none";
      document.getElementById("mainScreen").style.display = "flex";
    };

    document.getElementById("returnOrientationTrain").onclick = () => {
      document.getElementById("trainingPage").style.display = "none";
      document.getElementById("orientationPage").style.display = "block";
    };

    document.getElementById("returnOrientationLab").onclick = () => {
      document.getElementById("labPage").style.display = "none";
      document.getElementById("orientationPage").style.display = "block";
    };

    document.getElementById("returnOrientationExam").onclick = () => {
      document.getElementById("examPage").style.display = "none";
      document.getElementById("orientationPage").style.display = "block";
    };

    function loadTraining(dept) {
      document.getElementById("orientationPage").style.display = "none";
      document.getElementById("trainingPage").style.display = "block";
      document.getElementById("trainingDeptTitle").textContent = `${dept} Study`;
      document.getElementById("trainingCadetInfo").textContent = `Cadet ${cadetName} of ${homeworlds[species]}`;
      const content = document.getElementById("trainingContent");
      content.innerHTML = "<p>Loading...</p>";

      fetch(trainingFiles[dept])
        .then(r => r.json())
        .then(data => {
          content.innerHTML = "";
          if (prefaces[dept]) content.innerHTML += `<div class='training-preface'><p>${prefaces[dept]}</p></div>`;
          (data.study || []).forEach(item => {
            const s = document.createElement("div");
            s.className = "training-section";
            s.innerHTML = `<h3>${item.scenario}</h3><p>${item.summary || ""}</p>`;
            const div = document.createElement("div");
            div.className = "answers department-buttons-box";
            (item.answers || []).slice(0,3).forEach(ans => {
              div.innerHTML += `<p><strong>${ans.type === "best" ? "⭐ Best" : "Alternate"}:</strong> ${ans.text}<br><em>Score:</em> ${ans.score}<br>${ans.details || ""}</p>`;
            });
            s.appendChild(div);
            content.appendChild(s);
          });
        });
    }

    function loadLab(dept) {
      document.getElementById("orientationPage").style.display = "none";
      document.getElementById("labPage").style.display = "block";
      document.getElementById("labDeptTitle").textContent = `${dept} Lab`;
      document.getElementById("labCadetInfo").textContent = `Cadet ${cadetName} of ${homeworlds[species]}`;
      const content = document.getElementById("labContent");
      content.innerHTML = "<p>Loading...</p>";

      fetch(labFiles[dept])
        .then(r => r.json())
        .then(data => {
          const items = data.lab || data.study || [];
          if (!items.length) return content.innerHTML = "<p>No lab data found.</p>";
          let i = 0;
          show(i);
          function show(index) {
            const q = items[index];
            content.innerHTML = `<div class='training-section'><h3>${q.scenario}</h3><p>${q.summary}</p></div>`;
            const ansDiv = document.createElement("div");
            ansDiv.className = "lab-answers";
            [...q.answers].sort(() => Math.random() - 0.5).forEach(a => {
              const btn = document.createElement("button");
              btn.textContent = a.text;
              btn.onclick = () => {
                ansDiv.querySelectorAll("button").forEach(b => b.disabled = true);
                const fb = document.createElement("div");
                fb.className = "feedback";
                if (a.type === "best") fb.innerHTML = `<span class='best-answer'>✅ Correct — Best Answer!</span><p>${a.details}</p>`;
                else fb.innerHTML = `<span class='incorrect-answer'>❌ Incorrect.</span>`;
                const next = document.createElement("button");
                next.textContent = index < items.length - 1 ? "Next Scenario ➡️" : "Return to Departments";
                next.onclick = () => {
                  if (index < items.length - 1) show(index + 1);
                  else {
                    document.getElementById("labPage").style.display = "none";
                    document.getElementById("orientationPage").style.display = "block";
                  }
                };
                fb.appendChild(next);
                ansDiv.appendChild(fb);
              };
              ansDiv.appendChild(btn);
            });
            content.appendChild(ansDiv);
          }
        });
    }

    function loadExam(dept) {
      document.getElementById("orientationPage").style.display = "none";
      document.getElementById("examPage").style.display = "block";
      document.getElementById("examDeptTitle").textContent = `${dept} Final Exam`;
      document.getElementById("examCadetInfo").textContent = `Cadet ${cadetName} of ${homeworlds[species]}`;
      const content = document.getElementById("examContent");
      content.innerHTML = "<p>Loading exam...</p>";

      fetch(examFiles[dept])
        .then(r => r.json())
        .then(data => {
          const items = data.exam || data.study || [];
          if (!items.length) return content.innerHTML = "<p>No exam data found.</p>";

          const cadets = [{ name: cadetName, score: 0 }];
          const names = ["T'Lar", "Nog", "Harris", "M'Rella", "Vorek", "Shan", "D'Tan", "Talora", "Kellen"];
          names.forEach(n => cadets.push({ name: n, score: 0, bias: { best: Math.random()*0.4+0.3, alt: Math.random()*0.3+0.2 } }));
          const maxScore = items.length * 9;
          let index = 0;

          function renderBoard() {
            const rows = cadets.map(c => {
              const gpa = ((c.score / maxScore) * 4).toFixed(2);
              return `<tr><td>${c.name}</td><td>${c.score}</td><td>${gpa}</td></tr>`;
            }).join("");
            return `<table style="width:60%;margin:0 auto;color:#fff;border-collapse:collapse;">
              <tr style="color:var(--gold);"><th align="left">Cadet</th><th>Score</th><th>GPA</th></tr>${rows}</table>`;
          }

          function nextQuestion() {
            const q = items[index];
            content.innerHTML = `<div class='training-section'><h3>${q.scenario}</h3><p>${q.summary}</p></div>`;
            const ansDiv = document.createElement("div");
            ansDiv.className = "lab-answers";
            [...q.answers].sort(() => Math.random() - 0.5).forEach(a => {
              const btn = document.createElement("button");
              btn.textContent = a.text;
              btn.onclick = () => {
                ansDiv.querySelectorAll("button").forEach(b => b.disabled = true);
                cadets[0].score += a.score || 0;
                cadets.slice(1).forEach(sim => {
                  const roll = Math.random();
                  let pick;
                  if (roll < sim.bias.best) pick = q.answers.find(x => x.type === "best");
                  else if (roll < sim.bias.best + sim.bias.alt) pick = q.answers.find(x => x.type === "alternate");
                  else pick = q.answers.find(x => x.type === "incorrect");
                  sim.score += pick?.score || 0;
                });
                const fb = document.createElement("div");
                fb.className = "feedback";
                fb.innerHTML = a.type === "best" ? `<span class='best-answer'>✅ Correct!</span><p>${a.details}</p>` :
                                                 `<span class='incorrect-answer'>❌ Incorrect.</span>`;
                const next = document.createElement("button");
                next.textContent = index < items.length - 1 ? "Next Question ➡️" : "View Results";
                next.onclick = () => {
                  if (index < items.length - 1) { index++; nextQuestion(); }
                  else showResults();
                };
                fb.appendChild(next);
                content.innerHTML = renderBoard();
                content.appendChild(fb);
              };
              ansDiv.appendChild(btn);
            });
            content.appendChild(ansDiv);
          }

          function showResults() {
            const sorted = [...cadets].sort((a,b)=>b.score-a.score);
            const player = cadets[0];
            const playerGPA = ((player.score / maxScore)*4).toFixed(2);
            const playerRank = sorted.findIndex(c=>c.name===player.name)+1;
            const passed = playerGPA >= 3.0;
            let html = `<h2 class='page-title'>Exam Complete</h2>
              <p style='font-size:18pt;'>Final GPA: <strong>${playerGPA}</strong> — ${passed?"✅ Passed":"❌ Did Not Pass"}</p>
              <p style='font-size:14pt;'>Rank: ${playerRank}/${cadets.length}</p>
              <h3 style='color:var(--gold);margin-top:25px;'>Final Standings</h3><table style='width:70%;margin:0 auto;color:#fff;border-collapse:collapse;'>
              <tr style='color:var(--gold);'><th align='left'>Cadet</th><th>Score</th><th>GPA</th></tr>`;
            sorted.forEach(c=>{
              const g=((c.score/maxScore)*4).toFixed(2);
              html+=`<tr><td>${c.name}</td><td>${c.score}</td><td>${g}</td></tr>`;
            });
            html+=`</table><p style='margin-top:20px;'>${passed?"Congratulations, Cadet. You have met the minimum GPA requirement of 3.0 and are hereby eligible to graduate from Starfleet Academy.":"Unfortunately, your GPA fell below the 3.0 requirement. You may retake the final exam during the next evaluation period."}</p>
            <button id='examReturn'>Return to Departments</button>`;
            content.innerHTML=html;
            document.getElementById("examReturn").onclick=()=>{
              document.getElementById("examPage").style.display="none";
              document.getElementById("orientationPage").style.display="block";
            };
          }

          nextQuestion();
        })
        .catch(()=>content.innerHTML="<p>Error loading exam data.</p>");
    }
  });
  </script>
</body>
</html>
