<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Starfleet Academy</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root { --gold:#ffd84d; }
    html, body {
      height:100%;
      margin:0;
      padding:0;
      background-color:#000;
    }
    body {
      font-family:'Roboto', sans-serif;
      color:var(--gold);
      overflow-x:hidden;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
    }
    .page-title {
      margin-top:20px;
      margin-bottom:20px;
      font-family:'Orbitron', sans-serif;
      font-size:42pt;
      color:gold;
      text-align:center;
    }
    .container {
      background:rgba(0,0,0,0.8);
      padding:20px 30px;
      border-radius:12px;
      box-shadow:0 0 20px var(--gold);
      width:900px;
      margin:0 auto;
      text-align:left;
    }
    #mainScreen .container { width:500px; }

    label{ display:block; margin:12px 0 5px; }
    input,select,button{ width:100%; padding:8px; margin-bottom:15px; border:none; border-radius:6px; }
    input,select{ background:#333; color:#fff; font-family:'Roboto', sans-serif; }
    button{
      background:linear-gradient(to bottom,#1e3c72,#000000);
      color:var(--gold); font-weight:bold;
      border:2px solid var(--gold);
      cursor:pointer;
      box-shadow:inset 0 2px 5px rgba(255,255,255,.3), 0 5px 15px rgba(0,0,0,.6);
      font-family:'Roboto', sans-serif;
    }
    button:hover{ background:linear-gradient(to bottom,#2a5298,#111); transform:translateY(-2px); }

    .corner-image{ position:fixed; width:2.5in; height:2.5in; top:10px; object-fit:contain; z-index:0; pointer-events:none; }
    .corner-left{ left:10px; } .corner-right{ right:10px; }

    .orientation-root{ position:relative; z-index:1; display:flex; flex-direction:column; align-items:center; margin:0 auto; }
    .orientation-title{ font-family:'Orbitron', sans-serif; font-size:32pt; margin-top:60px; margin-bottom:20px; text-align:center; color:gold; }
    .orientation-text{ max-width:800px; margin:0 auto 40px auto; padding:0 20px; font-size:16pt; line-height:1.5em; text-align:center; font-family:'Roboto', sans-serif; }

    .button-box{
      margin-top:30px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:20px;
      background:rgba(0,0,0,0.4);
      padding:30px;
      border-radius:12px;
      box-shadow:0 0 15px var(--gold);
    }
    .button-box button{ font-size:20pt; padding:15px 25px; border-radius:12px; width:auto; }
    .return-btn{ padding:10px 25px; font-size:14pt; width:auto; margin-top:20px; }

    #trainingPage, #labPage, #examPage {
      display:none;
      padding:20px;
      height:100vh;
      overflow-y:auto;
      -webkit-overflow-scrolling:touch;
    }
    .training-title { font-family:'Orbitron', sans-serif; font-size:28pt; margin-bottom:20px; text-align:center; color:gold; }
    .training-section { margin-bottom:35px; padding-bottom:20px; border-bottom:1px solid #444; }
    .training-section h3 { font-family:'Roboto', sans-serif; font-size:15pt; margin-bottom:10px; color:var(--gold); }
    .training-section p { font-size:14pt; line-height:1.6em; margin:0 0 10px 0; color:#fff; }
    .answers { margin-left:20px; }
    .answer-block { margin-bottom:15px; padding:10px; background:rgba(255,255,255,0.05); border-radius:8px; }
    .answer-block strong { color:#00ffcc; }
    .answer-block p { color:#fff; }

    #trainingPage::-webkit-scrollbar, #labPage::-webkit-scrollbar, #examPage::-webkit-scrollbar { width:10px; }
    #trainingPage::-webkit-scrollbar-track, #labPage::-webkit-scrollbar-track, #examPage::-webkit-scrollbar-track { background:#111; }
    #trainingPage::-webkit-scrollbar-thumb, #labPage::-webkit-scrollbar-thumb, #examPage::-webkit-scrollbar-thumb {
      background:#555; border-radius:8px; border:2px solid #111;
    }
    #trainingPage::-webkit-scrollbar-thumb:hover, #labPage::-webkit-scrollbar-thumb:hover, #examPage::-webkit-scrollbar-thumb:hover { background:#888; }

    .fixed-return { position:fixed; bottom:20px; left:10px; z-index:1000; width:auto; }
    #examScoreboard { position:fixed; top:20px; right:20px; background:rgba(0,0,0,0.85); border:2px solid var(--gold);
      border-radius:12px; padding:10px; color:var(--gold); width:250px; }
    #examScoreboard h3 { margin:5px 0; font-family:'Orbitron'; text-align:center; }
    #examScoreboard table { width:100%; border-collapse:collapse; color:#fff; font-size:10pt; }
    #examScoreboard td { padding:3px 6px; }
    .highlight { color:#00ffcc; font-weight:bold; }
    #examProgress { font-size:11pt; margin-bottom:5px; text-align:center; }

    #accessMessage{ opacity:0; transition:opacity 1s; text-align:center; color:gold; font-size:18pt; margin-top:20px; }
  </style>
</head>
<body style="background-color:#000;">
  <div id="loginScreen" style="display:flex;flex-direction:column;align-items:center;">
    <div class="page-title">Starfleet Academy</div>
    <div class="container">
      <label for="cadetName">Cadet Name</label>
      <input type="text" id="cadetName" required>
      <label for="species">Species</label>
      <select id="species" required>
        <option value="">-- Select Species --</option>
        <option>Human</option><option>Vulcan</option><option>Andorian</option>
        <option>Tellarite</option><option>Bajoran</option><option>Betazoid</option>
        <option>Bolian</option><option>Trill</option><option>Klingon</option>
        <option>Ferengi</option><option>Denobulan</option><option>Orion</option>
        <option>Caitian</option><option>Benzite</option>
      </select>
      <button id="loginBtn">Login</button>
      <div id="accessMessage">Access Granted. Welcome to Starfleet Academy.</div>
    </div>
  </div>

  <div id="mainScreen" style="display:none;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">
    <div class="page-title">Welcome to Starfleet Academy</div>
    <div class="container" id="mainContainer">
      <div id="mainWelcome" style="text-align:center;font-size:18pt;margin-bottom:15px;"></div>
      <p style="text-align:center;font-size:14pt;line-height:1.6em;color:#fff;">
        Starfleet Academy is the Federation’s premiere institution for the training of future officers.
        Here, cadets are challenged to push the limits of intellect, integrity, and courage.
        The lessons learned here will prepare you to lead, explore, and uphold the ideals of the United Federation of Planets.
      </p>
      <div style="text-align:center;margin-top:30px;">
        <button id="trainingBtn">Training</button>
        <button id="labBtn">Labs</button>
        <button id="examBtn">Exam</button>
      </div>
    </div>
  </div>
  <div id="orientationPage" style="display:none;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">
    <div class="orientation-root">
      <div class="orientation-title">Select Department</div>
      <div class="orientation-text">Choose your department below to begin your next challenge.</div>
      <div class="button-box" id="moduleButtons"></div>
      <button class="return-btn" id="returnMain">Return to Main</button>
    </div>
  </div>

  <div id="trainingPage">
    <div class="page-title" id="trainingDeptTitle"></div>
    <div class="container" style="max-width:850px;" id="trainingContent"></div>
    <button class="return-btn fixed-return" id="returnOrientation">Back to Departments</button>
  </div>

  <div id="labPage">
    <div class="page-title" id="labDeptTitle"></div>
    <div class="container" style="max-width:850px;" id="labContent"></div>
    <button class="return-btn fixed-return" id="returnOrientationLab">Back to Departments</button>
  </div>

  <div id="examPage">
    <div class="page-title" id="examDeptTitle"></div>
    <div class="container" style="max-width:850px;" id="examContent"></div>
    <div id="examScoreboard">
      <h3>Class Rankings</h3>
      <div id="examProgress">Questions Answered: 0</div>
      <table id="rankingTable"></table>
    </div>
    <button class="return-btn fixed-return" id="returnOrientationExam">Back to Departments</button>
  </div>

  <script>
    // Species homeworld mapping
    const speciesHomeworld = {
      "Human": "Earth", "Vulcan": "Vulcan", "Andorian": "Andoria", "Tellarite": "Tellar Prime",
      "Bajoran": "Bajor", "Betazoid": "Betazed", "Bolian": "Bolarus IX", "Trill": "Trill",
      "Klingon": "Qo'noS", "Ferengi": "Ferenginar", "Denobulan": "Denobula",
      "Orion": "Orion", "Caitian": "Cait", "Benzite": "Benzar"
    };

    // Training JSON sources
    const trainingFiles = {
      "Command": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Command%20Training.json",
      "Diplomacy": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Diplomacy%20Training.json",
      "Engineering": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Engineering%20Training.json",
      "Security": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Security%20Training.json",
      "Science": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Science%20Training.json",
      "Medical": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Medical%20Training.json"
    };

    // Lab JSON sources
    const labFiles = {
      "Command": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Command%20Lab.json",
      "Diplomacy": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Diplomacy%20Lab.json",
      "Engineering": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Engineering%20Lab.json",
      "Security": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Security%20Lab.json",
      "Science": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Science%20Lab.json",
      "Medical": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Medical%20Lab.json"
    };

    // Department blurbs
    const prefaces = {
      "Command": "Command is not about absolute authority; it is about absolute responsibility. Every decision you make will weigh the balance of lives, mission objectives, and Federation principles.",
      "Diplomacy": "Diplomacy is the Federation’s first line of defense. As captain, your words may avert wars, your patience may save lives, and your restraint may preserve the values of the Federation.",
      "Engineering": "Starfleet ships are the finest in the galaxy, but they are only as strong as their engineers. Your ingenuity can mean the difference between survival and disaster.",
      "Security": "As Chief of Security, you must balance discipline with courage, and respond to every threat with calculated precision.",
      "Science": "Scientific discovery is the Federation’s guiding light. Curiosity must be tempered by responsibility and an understanding of consequence.",
      "Medical": "The health of your crew is the lifeblood of your ship. Compassion and decisiveness will guide you through crisis."
    };

    // Variables
    let cadetName = "", cadetSpecies = "", cadetHome = "";
    let currentDept = "", examProgress = 0, totalQuestions = 0;
    let cadets = [];

    // Login handler
    document.getElementById("loginBtn").addEventListener("click", ()=>{
      cadetName = document.getElementById("cadetName").value.trim();
      cadetSpecies = document.getElementById("species").value;
      if(!cadetName || !cadetSpecies) return alert("Please enter your name and species.");
      cadetHome = speciesHomeworld[cadetSpecies] || cadetSpecies;
      const accessMsg = document.getElementById("accessMessage");
      accessMsg.textContent = `Access Granted. Welcome, Cadet ${cadetName} of ${cadetHome}.`;
      accessMsg.style.opacity = 1;
      setTimeout(()=>{
        document.getElementById("loginScreen").style.transition = "opacity 5s";
        document.getElementById("loginScreen").style.opacity = 0;
        setTimeout(()=>{
          document.getElementById("loginScreen").style.display="none";
          document.getElementById("mainScreen").style.display="block";
          document.getElementById("mainWelcome").innerHTML = `Welcome, Cadet ${cadetName} of ${cadetHome}.`;
        },5000);
      },500);
    });
    // Button Handlers
    document.getElementById("trainingBtn").addEventListener("click", ()=>loadOrientation("training"));
    document.getElementById("labBtn").addEventListener("click", ()=>loadOrientation("lab"));
    document.getElementById("examBtn").addEventListener("click", ()=>loadOrientation("exam"));

    function loadOrientation(mode){
      document.getElementById("mainScreen").style.display="none";
      const page=document.getElementById("orientationPage");
      page.style.display="block";
      const btnBox=document.getElementById("moduleButtons");
      btnBox.innerHTML="";
      Object.keys(trainingFiles).forEach(dept=>{
        const b=document.createElement("button");
        b.textContent=dept;
        b.onclick=()=>{
          currentDept=dept;
          if(mode==="training") loadTraining(dept);
          else if(mode==="lab") loadLab(dept);
          else loadExam(dept);
        };
        btnBox.appendChild(b);
      });
    }

    // Return buttons
    document.getElementById("returnMain").onclick=()=>{
      document.getElementById("orientationPage").style.display="none";
      document.getElementById("mainScreen").style.display="block";
    };
    document.getElementById("returnOrientation").onclick=()=>{
      document.getElementById("trainingPage").style.display="none";
      document.getElementById("orientationPage").style.display="block";
    };
    document.getElementById("returnOrientationLab").onclick=()=>{
      document.getElementById("labPage").style.display="none";
      document.getElementById("orientationPage").style.display="block";
    };
    document.getElementById("returnOrientationExam").onclick=()=>{
      document.getElementById("examPage").style.display="none";
      document.getElementById("orientationPage").style.display="block";
    };

    // TRAINING MODE
    function loadTraining(dept){
      document.getElementById("orientationPage").style.display="none";
      document.getElementById("trainingPage").style.display="block";
      const content=document.getElementById("trainingContent");
      document.getElementById("trainingDeptTitle").textContent=`${dept} Training`;
      content.innerHTML="<p>Loading training material...</p>";
      fetch(trainingFiles[dept])
        .then(r=>r.json())
        .then(data=>{
          content.innerHTML="";
          const pre=document.createElement("div");
          pre.className="training-section";
          pre.innerHTML=`<p>${prefaces[dept]}</p>`;
          content.appendChild(pre);
          data.study.forEach(item=>{
            const section=document.createElement("div");
            section.className="training-section";
            let html=`<h3>${item.scenario}</h3><p>${item.summary}</p>`;
            if(item.answers){
              html+=`<div class='answers'>`;
              item.answers.forEach(ans=>{
                const label=ans.type==="best"?"⭐ Best Answer":"Alternate Answer";
                html+=`<div class='answer-block'><p><strong>${label}:</strong> ${ans.text}</p><p><em>Score:</em> ${ans.score}</p><p>${ans.details}</p></div>`;
              });
              html+=`</div>`;
            }
            section.innerHTML=html;
            content.appendChild(section);
          });
        })
        .catch(()=>{ content.innerHTML="<p>Failed to load training data.</p>"; });
    }

    // LAB MODE
    function loadLab(dept){
      document.getElementById("orientationPage").style.display="none";
      document.getElementById("labPage").style.display="block";
      const content=document.getElementById("labContent");
      document.getElementById("labDeptTitle").textContent=`${dept} Lab`;
      content.innerHTML="<p>Loading lab simulation...</p>";
      fetch(labFiles[dept])
        .then(r=>r.json())
        .then(data=>{
          content.innerHTML="";
          const pre=document.createElement("div");
          pre.className="training-section";
          pre.innerHTML=`<p>${prefaces[dept]}</p>`;
          content.appendChild(pre);
          data.study.forEach(item=>{
            const section=document.createElement("div");
            section.className="training-section";
            let html=`<h3>${item.scenario}</h3><p>${item.summary}</p>`;
            if(item.answers){
              html+=`<div class='answers'>`;
              item.answers.forEach(ans=>{
                const label=ans.type==="best"?"⭐ Best Answer":"Alternate Answer";
                html+=`<div class='answer-block'><p><strong>${label}:</strong> ${ans.text}</p><p><em>Score:</em> ${ans.score}</p><p>${ans.details}</p></div>`;
              });
              html+=`</div>`;
            }
            section.innerHTML=html;
            content.appendChild(section);
          });
        })
        .catch(()=>{ content.innerHTML="<p>Failed to load lab data.</p>"; });
    }

    // EXAM MODE
    function loadExam(dept){
      document.getElementById("orientationPage").style.display="none";
      document.getElementById("examPage").style.display="block";
      const content=document.getElementById("examContent");
      const table=document.getElementById("rankingTable");
      const progress=document.getElementById("examProgress");
      document.getElementById("examDeptTitle").textContent=`${dept} Exam`;
      content.innerHTML="<p>Loading exam...</p>";
      cadets = Array.from({length:9},(_,i)=>({
        name:`Cadet ${i+1}`,
        gpa:(3.2+Math.random()*0.7).toFixed(2)
      }));
      examProgress=0;
      fetch(trainingFiles[dept])
        .then(r=>r.json())
        .then(data=>{
          const scenarios=data.study.sort(()=>0.5-Math.random()).slice(0,10);
          totalQuestions=scenarios.length;
          let index=0; let score=0;
          content.innerHTML="";
          nextQuestion();
          updateRankings();

          function nextQuestion(){
            if(index>=scenarios.length){
              content.innerHTML=`<h3>Exam Complete</h3><p>Your final score: ${score}</p>`;
              return;
            }
            const q=scenarios[index];
            const qDiv=document.createElement("div");
            qDiv.className="training-section";
            let html=`<h3>${q.scenario}</h3><p>${q.summary}</p>`;
            html+=`<div class='answers'>`;
            const allAnswers=[...q.answers];
            allAnswers.sort(()=>Math.random()-0.5);
            allAnswers.forEach(ans=>{
              html+=`<button class='answerBtn' data-score='${ans.score}'>${ans.text}</button>`;
            });
            html+=`</div>`;
            qDiv.innerHTML=html;
            content.innerHTML="";
            content.appendChild(qDiv);
            document.querySelectorAll(".answerBtn").forEach(btn=>{
              btn.onclick=()=>{
                const val=Number(btn.getAttribute("data-score"));
                score+=val;
                examProgress++;
                progress.textContent=`Questions Answered: ${examProgress}`;
                index++;
                updateRankings(score);
                nextQuestion();
              };
            });
          }

          function updateRankings(playerScore=0){
            const playerGPA=Math.min(4,playerScore/totalQuestions/2.5).toFixed(2);
            table.innerHTML="";
            const all=[...cadets,{name:`${cadetName}`,gpa:playerGPA}].sort((a,b)=>b.gpa-a.gpa);
            all.forEach(c=>{
              const row=document.createElement("tr");
              const nameCell=document.createElement("td");
              const gpaCell=document.createElement("td");
              nameCell.textContent=c.name;
              gpaCell.textContent=c.gpa;
              if(c.name===cadetName) nameCell.classList.add("highlight");
              row.appendChild(nameCell);
              row.appendChild(gpaCell);
              table.appendChild(row);
            });
          }
        })
        .catch(()=>{ content.innerHTML="<p>Failed to load exam data.</p>"; });
    }
  </script>
</body>
</html>
