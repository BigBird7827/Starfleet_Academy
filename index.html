<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Starfleet Academy</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --gold: #FFCC66;
      --pale-canary: #FFFF99;
      --tanoi: #FFCC99;
      --golden-tanoi: #FFCC66;
      --neon-carrot: #FF9933;
      --eggplant: #664466;
      --anakiwa: #99CCFF;
      --mariner: #3366CC;
      --bahama: #006699;
      --screen-bg: #000000;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--screen-bg);
      font-family: 'Roboto', sans-serif;
      color: var(--gold);
    }
    #loginScreen {
      position: relative;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: #000;
    }
    #loginScreen::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 40%;
      height: 8px;
      background: var(--neon-carrot);
    }
    #loginScreen::after {
      content: "";
      position: absolute;
      bottom: 0;
      right: 0;
      width: 40%;
      height: 8px;
      background: var(--anakiwa);
    }
    .lcars-elbow-left {
      position: absolute;
      top: 50%;
      left: 0;
      width: 60px;
      height: 60px;
      background: var(--eggplant);
      border-radius: 0 60px 60px 0;
      transform: translateY(-50%);
    }
    .lcars-elbow-right {
      position: absolute;
      top: 50%;
      right: 0;
      width: 60px;
      height: 60px;
      background: var(--bahama);
      border-radius: 60px 0 0 60px;
      transform: translateY(-50%);
    }
    .page-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 36pt;
      margin: 20px 0 40px;
      color: var(--pale-canary);
    }
    .container {
      background: rgba(0,0,0,0.8);
      padding: 30px 40px;
      border-radius: 12px;
      width: 360px;
      box-shadow: 0 0 20px var(--golden-tanoi);
      position: relative;
      z-index: 1;
    }
    label {
      display: block;
      margin: 12px 0 4px;
      font-size: 13pt;
      color: var(--gold);
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: none;
      border-radius: 6px;
      background: #111;
      color: #fff;
      font-size: 14pt;
      outline: none;
    }
    button {
      width: 100%;
      padding: 12px;
      background: var(--mariner);
      color: var(--gold);
      font-family: 'Orbitron', sans-serif;
      font-size: 18pt;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 0 15px rgba(255,204,102,0.4);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    button:hover {
      transform: scale(1.03);
      box-shadow: 0 0 25px var(--gold);
    }
    #accessMessage {
      text-align: center;
      color: var(--gold);
      font-family: 'Orbitron', sans-serif;
      font-size: 16pt;
      margin-top: 12px;
      opacity: 0;
      transition: opacity 0.5s ease-in;
    }
  </style>
</head>
<body>
  <div id="loginScreen">
    <div class="lcars-elbow-left"></div>
    <div class="lcars-elbow-right"></div>
    <div class="page-title">WELCOME</div>
    <div class="container">
      <label for="cadetName">Cadet Name</label>
      <input type="text" id="cadetName" required>
      <label for="species">Species</label>
      <select id="species" required>
        <option value="">-- Select Species --</option>
        <option>Human</option>
        <option>Vulcan</option>
        <option>Andorian</option>
        <option>Tellarite</option>
        <option>Bajoran</option>
        <option>Betazoid</option>
        <option>Bolian</option>
        <option>Trill</option>
        <option>Klingon</option>
        <option>Ferengi</option>
        <option>Denobulan</option>
        <option>Orion</option>
        <option>Caitian</option>
        <option>Benzite</option>
      </select>
      <button id="loginBtn">LOGIN</button>
      <p id="accessMessage">ACCESS GRANTED</p>
    </div>
  </div>
  <div id="mainScreen" style="display:none;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">
    <div class="page-title">Welcome to Starfleet Academy</div>
    <div id="mainWelcome"></div>
    <div class="container" style="text-align:center;">
      <p>
        Congratulations, Cadet. You have been accepted into Starfleet Academy,
        where the finest minds of the Federation prepare to serve in the vast
        frontier of space. Here, you will learn the disciplines of command,
        diplomacy, science, engineering, medicine, and security — each a vital
        pillar in the exploration and defense of the Federation.
      </p>
      <p>
        Choose your path and begin your training or participate in interactive
        labs and exams to test your readiness for active duty.
      </p>
      <div style="margin-top:30px;">
        <button id="trainingBtn" style="width:45%;font-size:18pt;">Training</button>
        <button id="labBtn" style="width:45%;font-size:18pt;">Labs</button>
        <button id="examBtn" style="width:45%;font-size:18pt;">Exams</button>
      </div>
    </div>
  </div>
  <div id="orientationPage" style="display:none;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">
    <div class="orientation-root">
      <div class="orientation-title" id="orientationTitle"></div>
      <div class="orientation-text">Select a department to begin.</div>
      <div class="button-box" id="moduleButtons"></div>
      <button class="return-btn" id="returnMain">Return to Main</button>
    </div>
  </div>
  <div id="trainingPage" style="display:none;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">
    <div class="page-title" id="trainingDeptTitle"></div>
    <div style="text-align:center;color:var(--gold);font-size:18pt;" id="trainingCadetInfo"></div>
    <div class="container" id="trainingContent" style="width:calc(100% - 320px);margin:0 auto;"></div>
    <button class="return-btn fixed-return" id="returnOrientationTrain">Back to Departments</button>
  </div>
  <div id="labPage" style="display:none;">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-left" alt="">
    <img src="https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Starfleet%20Academy%20Orientation.png" class="corner-image corner-right" alt="">
    <div class="page-title" id="labDeptTitle"></div>
    <div style="text-align:center;color:var(--gold);font-size:18pt;" id="labCadetInfo"></div>
    <div class="container" id="labContent" style="width:calc(100% - 320px);margin:0 auto;"></div>
    <button class="return-btn fixed-return" id="returnOrientationLab">Back to Departments</button>
  </div>
  <div id="examPage" style="display:none;">
    <div id="examScoreboard">
      <h3>Class Rankings</h3>
      <div id="examProgress">Questions Answered: 0</div>
      <table id="cadetTable"></table>
    </div>
    <div class="page-title" id="examDeptTitle"></div>
    <div style="text-align:center;color:var(--gold);font-size:18pt;" id="examCadetInfo"></div>
    <div class="container" id="examContent" style="width:calc(100% - 320px);margin:0 auto;"></div>
    <button class="return-btn fixed-return" id="returnOrientationExam">Back to Departments</button>
  </div>
  <script>
    const trainingFiles = {
      "Command": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Command%20Training.json",
      "Diplomacy": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Diplomacy%20Training.json",
      "Engineering": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Engineering%20Training.json",
      "Security": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Security%20Training.json",
      "Science": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Science%20Training.json",
      "Medical": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Medical%20Training.json"
    };

    const labFiles = {
      "Command": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Command%20Lab.json",
      "Diplomacy": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Diplomacy%20Lab.json",
      "Engineering": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Engineering%20Lab.json",
      "Security": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Security%20Lab.json",
      "Science": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Science%20Lab.json",
      "Medical": "https://raw.githubusercontent.com/BigBird7827/Starfleet_Academy/main/Medical%20Lab.json"
    };

    const examFiles = { ...trainingFiles };

    const prefaces = {
      "Command": "Command is not about absolute authority; it is about absolute responsibility. Every decision you make will weigh the balance of lives, mission objectives, and Federation principles.",
      "Diplomacy": "Diplomacy is the Federation’s first line of defense. Your words may avert wars, your patience may save lives, and your restraint may preserve the values of the Federation.",
      "Engineering": "Starfleet ships are only as strong as their engineers. You direct damage control, enforce safety, and keep the vessel operational under pressure.",
      "Science": "Exploration is our mandate. Balance curiosity with caution, and interpret data to guide the mission safely and ethically.",
      "Medical": "You are responsible for the health and safety of every crew member. Combine empathy, expertise, and decisive action.",
      "Security": "Maintain order, enforce protocols, and respond to threats with precision while balancing defense with operational priorities."
    };

    let cadetName = "";
    let species = "";

    const homeworlds = {
      "Human": "Earth", "Vulcan": "Vulcan", "Andorian": "Andoria", "Tellarite": "Tellar Prime",
      "Bajoran": "Bajor", "Betazoid": "Betazed", "Bolian": "Bolarus IX", "Trill": "Trill",
      "Klingon": "Qo'noS", "Ferengi": "Ferenginar", "Denobulan": "Denobula", "Orion": "Orion",
      "Caitian": "Cait", "Benzite": "Benzar"
    };

    document.getElementById("loginBtn").addEventListener("click", () => {
      cadetName = document.getElementById("cadetName").value.trim();
      species = document.getElementById("species").value;
      if (!cadetName || !species) return alert("Enter name and species first.");
      const msg = document.getElementById("accessMessage");
      msg.textContent = `ACCESS GRANTED — Cadet ${cadetName} of ${homeworlds[species]}`;
      msg.style.opacity = 1;
      setTimeout(() => {
        document.getElementById("loginScreen").style.display = "none";
        document.getElementById("mainWelcome").textContent = `Welcome, Cadet ${cadetName} of ${homeworlds[species]}.`;
        document.getElementById("mainScreen").style.display = "block";
      }, 5000);
    });

    document.getElementById("trainingBtn").addEventListener("click", () => openOrientation("training"));
    document.getElementById("labBtn").addEventListener("click", () => openOrientation("lab"));
    document.getElementById("examBtn").addEventListener("click", () => openOrientation("exam"));

    function openOrientation(mode) {
      document.getElementById("mainScreen").style.display = "none";
      const title = document.getElementById("orientationTitle");
      title.textContent = mode === "exam" ? "Select Exam Department" :
                          mode === "lab"  ? "Select Lab Department"  :
                                            "Select Training Department";

      const btnBox = document.getElementById("moduleButtons");
      btnBox.innerHTML = "";
      Object.keys(trainingFiles).forEach(dept => {
        const b = document.createElement("button");
        b.textContent = dept;
        b.onclick = () => {
          if (mode === "training") loadTraining(dept);
          else if (mode === "lab") loadLab(dept);
          else loadExam(dept);
        };
        btnBox.appendChild(b);
      });
      document.getElementById("orientationPage").style.display = "block";
    }

    document.getElementById("returnMain").onclick = () => {
      document.getElementById("orientationPage").style.display = "none";
      document.getElementById("mainScreen").style.display = "block";
    };

    document.getElementById("returnOrientationTrain").onclick = () => {
      document.getElementById("trainingPage").style.display = "none";
      document.getElementById("orientationPage").style.display = "block";
    };

    document.getElementById("returnOrientationLab").onclick = () => {
      document.getElementById("labPage").style.display = "none";
      document.getElementById("orientationPage").style.display = "block";
    };

    document.getElementById("returnOrientationExam").onclick = () => {
      document.getElementById("examPage").style.display = "none";
      document.getElementById("orientationPage").style.display = "block";
    };

    function loadTraining(dept) {
      document.getElementById("orientationPage").style.display = "none";
      document.getElementById("trainingPage").style.display = "block";

      document.getElementById("trainingDeptTitle").textContent = `${dept} Training`;
      document.getElementById("trainingCadetInfo").textContent = `Cadet ${cadetName} of ${homeworlds[species]}`;

      const content = document.getElementById("trainingContent");
      content.innerHTML = "<p>Loading...</p>";

      fetch(trainingFiles[dept])
        .then(r => r.json())
        .then(data => {
          content.innerHTML = "";
          if (prefaces[dept]) {
            const pre = document.createElement("div");
            pre.className = "training-section";
            pre.innerHTML = `<p>${prefaces[dept]}</p>`;
            content.appendChild(pre);
          }
          if (data.study) {
            data.study.forEach(item => {
              const section = document.createElement("div");
              section.className = "training-section";
              section.innerHTML = `<h3>${item.scenario}</h3><p>${item.summary || ""}</p>`;
              if (item.answers) {
                const answersDiv = document.createElement("div");
                answersDiv.className = "answers";
                item.answers.forEach(ans => {
                  const block = document.createElement("div");
                  block.className = "answer-block";
                  const label = ans.type === "best" ? "⭐ Best Answer" : "Alternate Answer";
                  block.innerHTML = `<p><strong>${label}:</strong> ${ans.text}</p><p><em>Score:</em> ${ans.score}</p><p>${ans.details || ""}</p>`;
                  answersDiv.appendChild(block);
                });
                section.appendChild(answersDiv);
              }
              content.appendChild(section);
            });
          } else {
            content.innerHTML = "<p>No training items found.</p>";
          }
        });
    }

    function loadLab(dept) {
      document.getElementById("orientationPage").style.display = "none";
      document.getElementById("labPage").style.display = "block";

      document.getElementById("labDeptTitle").textContent = `${dept} Lab`;
      document.getElementById("labCadetInfo").textContent = `Cadet ${cadetName} of ${homeworlds[species]}`;

      const content = document.getElementById("labContent");
      content.innerHTML = "<p>Loading...</p>";

      fetch(labFiles[dept])
        .then(r => r.json())
        .then(data => {
          content.innerHTML = "";
          if (!(data.lab && data.lab.length)) {
            content.innerHTML = "<p>No lab scenarios found.</p>";
            return;
          }
          let index = 0;
          function renderScenario() {
            const item = data.lab[index];
            content.innerHTML = `
              <div class='training-section'>
                <h3>${item.scenario}</h3>
                <p>${item.summary || ""}</p>
              </div>
            `;
            const answersDiv = document.createElement("div");
            answersDiv.className = "answers";
            item.answers.forEach(ans => {
              const btn = document.createElement("button");
              btn.textContent = ans.text;
              btn.onclick = () => evaluate(ans, item);
              answersDiv.appendChild(btn);
            });
            content.appendChild(answersDiv);
          }
          function evaluate(ans, item) {
            document.querySelectorAll("#labContent .answers button").forEach(b => b.disabled = true);
            const best = item.answers.find(a => a.type === "best");
            const feedback = document.createElement("div");
            if (ans.type === "best") {
              feedback.innerHTML = `<strong>Correct.</strong> ${ans.details}`;
            } else if (ans.type === "alternate") {
              feedback.innerHTML = `<strong>Acceptable.</strong> ${ans.details}<br><br>The best action would have been:<br><em>${best.text}</em>`;
            } else {
              feedback.innerHTML = `<strong>Incorrect.</strong> ${ans.details}<br><br>The correct course of action:<br><em>${best.text}</em>`;
            }
            content.appendChild(feedback);
            const next = document.createElement("button");
            next.textContent = index < data.lab.length - 1 ? "Next Scenario" : "Finish Lab";
            next.onclick = () => {
              index++;
              if (index < data.lab.length) renderScenario();
              else content.innerHTML = `<h3>Lab Complete</h3>`;
            };
            content.appendChild(next);
          }
          renderScenario();
        });
    }

    function loadExam(dept) {
      document.getElementById("orientationPage").style.display = "none";
      document.getElementById("examPage").style.display = "block";

      document.getElementById("examDeptTitle").textContent = `${dept} Exam`;
      document.getElementById("examCadetInfo").textContent = `Cadet ${cadetName} of ${homeworlds[species]}`;

      const content = document.getElementById("examContent");
      const table = document.getElementById("cadetTable");
      const progress = document.getElementById("examProgress");

      const classmates = [
        { name: cadetName, gpa: 0.00, self: true },
        { name: "T'Lor", gpa: 0.00 }, { name: "Dax", gpa: 0.00 }, { name: "Nog", gpa: 0.00 },
        { name: "Paris", gpa: 0.00 }, { name: "Vorik", gpa: 0.00 }, { name: "Ro", gpa: 0.00 },
        { name: "O'Brien", gpa: 0.00 }, { name: "Leeta", gpa: 0.00 }, { name: "Torres", gpa: 0.00 }
      ];

      let answered = 0, total = 0;

      function updateScoreboard() {
        const rows = [...classmates].sort((a,b)=>b.gpa-a.gpa)
          .map(c => `<tr class='${c.self ? "highlight" : ""}'><td>${c.self ? "You" : c.name}</td><td style="text-align:right;">${c.gpa.toFixed(2)}</td></tr>`)
          .join("");
        table.innerHTML = rows;
        progress.textContent = `Questions Answered: ${answered}`;
      }

      fetch(examFiles[dept])
        .then(r => r.json())
        .then(data => {
          const questions = data.study.slice(0, 15);
          let index = 0;
          function renderQuestion() {
            const q = questions[index];
            content.innerHTML = `
              <div class='training-section'>
                <h3>${q.scenario}</h3>
                <p>${q.summary || ""}</p>
              </div>
            `;
            const answersDiv = document.createElement("div");
            answersDiv.className = "answers";
            let allAnswers = [...q.answers];
            if (allAnswers.length < 5) {
              allAnswers.push({ text: "Reroute main deflector through EPS grid.", score: 0, type: "wrong", details: "This would destabilize the system." });
              allAnswers.push({ text: "Ignore the situation and await orders.", score: 0, type: "wrong", details: "Inaction in crisis situations is unacceptable in Starfleet." });
            }
            allAnswers.sort(() => Math.random() - 0.5);
            allAnswers.forEach(a => {
              const btn = document.createElement("button");
              btn.textContent = a.text;
              btn.onclick = () => evaluate(a, q);
              answersDiv.appendChild(btn);
            });
            content.appendChild(answersDiv);
          }
          function evaluate(ans, q) {
            document.querySelectorAll("#examContent .answers button").forEach(b => b.disabled = true);
            const best = q.answers.find(a => a.type === "best");
            const feedback = document.createElement("div");
            if (ans.type === "best") {
              feedback.innerHTML = `<strong>Correct.</strong> ${ans.details}`;
              total += ans.score;
            } else if (ans.type === "alternate") {
              feedback.innerHTML = `<strong>Acceptable.</strong> ${ans.details}<br><br>The best answer was:<br><em>${best.text}</em>`;
              total += ans.score;
            } else {
              feedback.innerHTML = `<strong>Incorrect.</strong> ${ans.details}<br><br>The correct response was:<br><em>${best.text}</em>`;
            }
            content.appendChild(feedback);
            answered++;
            const gpa = ((total / (answered * 10)) * 4) || 0;
            classmates.find(c => c.self).gpa = gpa;
            updateScoreboard();
            const next = document.createElement("button");
            next.textContent = index < questions.length - 1 ? "Next Question" : "Finish Exam";
            next.onclick = () => {
              index++;
              if (index < questions.length) renderQuestion();
              else content.innerHTML = `<h3>Exam Complete</h3><p>Your total score: ${total}<br>Your final GPA: ${gpa.toFixed(2)}</p>`;
            };
            content.appendChild(next);
          }
          updateScoreboard();
          renderQuestion();
        });
    }
  </script>
</body>
</html>
